[2024-02-24 03:56:51,599] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: kafka_stream.virtualenv_python scheduled__2024-02-23T00:00:00+00:00 [queued]>
[2024-02-24 03:56:51,641] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: kafka_stream.virtualenv_python scheduled__2024-02-23T00:00:00+00:00 [queued]>
[2024-02-24 03:56:51,641] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-02-24 03:56:51,641] {taskinstance.py:1239} INFO - Starting attempt 1 of 2
[2024-02-24 03:56:51,642] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-02-24 03:56:51,704] {taskinstance.py:1259} INFO - Executing <Task(PythonVirtualenvOperator): virtualenv_python> on 2024-02-23 00:00:00+00:00
[2024-02-24 03:56:51,719] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'kafka_stream', 'virtualenv_python', 'scheduled__2024-02-23T00:00:00+00:00', '--job-id', '28', '--raw', '--subdir', 'DAGS_FOLDER/kafka_stream.py', '--cfg-path', '/tmp/tmpk68ksa4l', '--error-file', '/tmp/tmpaa_s1k8d']
[2024-02-24 03:56:51,732] {standard_task_runner.py:77} INFO - Job 28: Subtask virtualenv_python
[2024-02-24 03:56:51,716] {standard_task_runner.py:52} INFO - Started process 93 to run task
[2024-02-24 03:56:51,926] {logging_mixin.py:109} INFO - Running <TaskInstance: kafka_stream.virtualenv_python scheduled__2024-02-23T00:00:00+00:00 [running]> on host 8befa3b03ae8
[2024-02-24 03:56:52,036] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=mahesh@somemail.com
AIRFLOW_CTX_DAG_OWNER=Mahesh Pathak
AIRFLOW_CTX_DAG_ID=kafka_stream
AIRFLOW_CTX_TASK_ID=virtualenv_python
AIRFLOW_CTX_EXECUTION_DATE=2024-02-23T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-02-23T00:00:00+00:00
[2024-02-24 03:56:52,038] {process_utils.py:160} INFO - Executing cmd: /usr/local/bin/python -m virtualenv /tmp/venvbcqyfdg4
[2024-02-24 03:56:52,079] {process_utils.py:164} INFO - Output:
[2024-02-24 03:56:57,493] {process_utils.py:168} INFO - created virtual environment CPython3.6.15.final.0-64 in 3959ms
[2024-02-24 03:56:57,495] {process_utils.py:168} INFO -   creator CPython3Posix(dest=/tmp/venvbcqyfdg4, clear=False, no_vcs_ignore=False, global=False)
[2024-02-24 03:56:57,496] {process_utils.py:168} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/***/.local/share/virtualenv)
[2024-02-24 03:56:57,496] {process_utils.py:168} INFO -     added seed packages: pip==21.3.1, setuptools==58.3.0, wheel==0.37.0
[2024-02-24 03:56:57,497] {process_utils.py:168} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2024-02-24 03:56:57,825] {process_utils.py:160} INFO - Executing cmd: /tmp/venvbcqyfdg4/bin/pip install Faker kafka-python
[2024-02-24 03:56:57,891] {process_utils.py:164} INFO - Output:
[2024-02-24 03:57:17,978] {process_utils.py:168} INFO - Collecting Faker
[2024-02-24 03:57:18,165] {process_utils.py:168} INFO -   Downloading Faker-14.2.1-py3-none-any.whl (1.6 MB)
[2024-02-24 03:57:18,891] {process_utils.py:168} INFO - Collecting kafka-python
[2024-02-24 03:57:18,973] {process_utils.py:168} INFO -   Downloading kafka_python-2.0.2-py2.py3-none-any.whl (246 kB)
[2024-02-24 03:57:19,377] {process_utils.py:168} INFO - Collecting python-dateutil>=2.4
[2024-02-24 03:57:19,435] {process_utils.py:168} INFO -   Downloading python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)
[2024-02-24 03:57:19,821] {process_utils.py:168} INFO - Collecting typing-extensions>=3.7.4.3
[2024-02-24 03:57:19,899] {process_utils.py:168} INFO -   Downloading typing_extensions-4.1.1-py3-none-any.whl (26 kB)
[2024-02-24 03:57:20,267] {process_utils.py:168} INFO - Collecting six>=1.5
[2024-02-24 03:57:20,336] {process_utils.py:168} INFO -   Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)
[2024-02-24 03:57:20,581] {process_utils.py:168} INFO - Installing collected packages: six, typing-extensions, python-dateutil, kafka-python, Faker
[2024-02-24 03:57:27,893] {process_utils.py:168} INFO - Successfully installed Faker-14.2.1 kafka-python-2.0.2 python-dateutil-2.8.2 six-1.16.0 typing-extensions-4.1.1
[2024-02-24 03:57:28,641] {process_utils.py:160} INFO - Executing cmd: /tmp/venvbcqyfdg4/bin/python /tmp/venvbcqyfdg4/script.py /tmp/venvbcqyfdg4/script.in /tmp/venvbcqyfdg4/script.out /tmp/venvbcqyfdg4/string_args.txt
[2024-02-24 03:57:28,665] {process_utils.py:164} INFO - Output:
[2024-02-24 03:57:30,073] {process_utils.py:168} INFO - Traceback (most recent call last):
[2024-02-24 03:57:30,073] {process_utils.py:168} INFO -   File "/tmp/venvbcqyfdg4/script.py", line 58, in <module>
[2024-02-24 03:57:30,073] {process_utils.py:168} INFO -     res = stream_data(*arg_dict["args"], **arg_dict["kwargs"])
[2024-02-24 03:57:30,073] {process_utils.py:168} INFO -   File "/tmp/venvbcqyfdg4/script.py", line 43, in stream_data
[2024-02-24 03:57:30,073] {process_utils.py:168} INFO -     value_serializer=json_serrializer)
[2024-02-24 03:57:30,074] {process_utils.py:168} INFO -   File "/tmp/venvbcqyfdg4/lib/python3.6/site-packages/kafka/producer/kafka.py", line 383, in __init__
[2024-02-24 03:57:30,074] {process_utils.py:168} INFO -     **self.config)
[2024-02-24 03:57:30,074] {process_utils.py:168} INFO -   File "/tmp/venvbcqyfdg4/lib/python3.6/site-packages/kafka/client_async.py", line 244, in __init__
[2024-02-24 03:57:30,074] {process_utils.py:168} INFO -     self.config['api_version'] = self.check_version(timeout=check_timeout)
[2024-02-24 03:57:30,075] {process_utils.py:168} INFO -   File "/tmp/venvbcqyfdg4/lib/python3.6/site-packages/kafka/client_async.py", line 900, in check_version
[2024-02-24 03:57:30,075] {process_utils.py:168} INFO -     raise Errors.NoBrokersAvailable()
[2024-02-24 03:57:30,075] {process_utils.py:168} INFO - kafka.errors.NoBrokersAvailable: NoBrokersAvailable
[2024-02-24 03:57:30,574] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 393, in execute
    return super().execute(context=serializable_context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 432, in execute_callable
    string_args_filename,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/process_utils.py", line 172, in execute_in_subprocess
    raise subprocess.CalledProcessError(exit_code, cmd)
subprocess.CalledProcessError: Command '['/tmp/venvbcqyfdg4/bin/python', '/tmp/venvbcqyfdg4/script.py', '/tmp/venvbcqyfdg4/script.in', '/tmp/venvbcqyfdg4/script.out', '/tmp/venvbcqyfdg4/string_args.txt']' returned non-zero exit status 1.
[2024-02-24 03:57:30,591] {taskinstance.py:1277} INFO - Marking task as UP_FOR_RETRY. dag_id=kafka_stream, task_id=virtualenv_python, execution_date=20240223T000000, start_date=20240224T035651, end_date=20240224T035730
[2024-02-24 03:57:30,599] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,599] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,600] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,600] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,600] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,600] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,600] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,600] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,601] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,601] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,601] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,601] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-02-24 03:57:30,620] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/email.py:102: PendingDeprecationWarning: Fetching SMTP credentials from configuration variables will be deprecated in a future release. Please set credentials using a connection instead.
  send_mime_email(e_from=smtp_mail_from, e_to=recipients, mime_msg=msg, conn_id=conn_id, dryrun=dryrun)

[2024-02-24 03:57:30,620] {configuration.py:381} WARNING - section/key [smtp/smtp_user] not found in config
[2024-02-24 03:57:30,621] {email.py:208} INFO - Email alerting: attempt 1
[2024-02-24 03:57:30,631] {configuration.py:381} WARNING - section/key [smtp/smtp_user] not found in config
[2024-02-24 03:57:30,631] {email.py:208} INFO - Email alerting: attempt 1
[2024-02-24 03:57:30,632] {taskinstance.py:1751} ERROR - Failed to send email to: ['mahesh@somemail.com']
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 393, in execute
    return super().execute(context=serializable_context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 432, in execute_callable
    string_args_filename,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/process_utils.py", line 172, in execute_in_subprocess
    raise subprocess.CalledProcessError(exit_code, cmd)
subprocess.CalledProcessError: Command '['/tmp/venvbcqyfdg4/bin/python', '/tmp/venvbcqyfdg4/script.py', '/tmp/venvbcqyfdg4/script.in', '/tmp/venvbcqyfdg4/script.out', '/tmp/venvbcqyfdg4/string_args.txt']' returned non-zero exit status 1.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 2093, in email_alert
    send_email(self.task.email, subject, html_content)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 66, in send_email
    **kwargs,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 102, in send_email_smtp
    send_mime_email(e_from=smtp_mail_from, e_to=recipients, mime_msg=msg, conn_id=conn_id, dryrun=dryrun)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 210, in send_mime_email
    conn = _get_smtp_connection(smtp_host, smtp_port, smtp_timeout, smtp_ssl)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 244, in _get_smtp_connection
    else smtplib.SMTP(host=host, port=port, timeout=timeout)
  File "/usr/local/lib/python3.6/smtplib.py", line 251, in __init__
    (code, msg) = self.connect(host, port)
  File "/usr/local/lib/python3.6/smtplib.py", line 336, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "/usr/local/lib/python3.6/smtplib.py", line 307, in _get_socket
    self.source_address)
  File "/usr/local/lib/python3.6/socket.py", line 724, in create_connection
    raise err
  File "/usr/local/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
OSError: [Errno 99] Cannot assign requested address

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1749, in handle_failure
    self.email_alert(error)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 2095, in email_alert
    send_email(self.task.email, subject, html_content_err)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 66, in send_email
    **kwargs,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 102, in send_email_smtp
    send_mime_email(e_from=smtp_mail_from, e_to=recipients, mime_msg=msg, conn_id=conn_id, dryrun=dryrun)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 210, in send_mime_email
    conn = _get_smtp_connection(smtp_host, smtp_port, smtp_timeout, smtp_ssl)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/email.py", line 244, in _get_smtp_connection
    else smtplib.SMTP(host=host, port=port, timeout=timeout)
  File "/usr/local/lib/python3.6/smtplib.py", line 251, in __init__
    (code, msg) = self.connect(host, port)
  File "/usr/local/lib/python3.6/smtplib.py", line 336, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "/usr/local/lib/python3.6/smtplib.py", line 307, in _get_socket
    self.source_address)
  File "/usr/local/lib/python3.6/socket.py", line 724, in create_connection
    raise err
  File "/usr/local/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
OSError: [Errno 99] Cannot assign requested address
[2024-02-24 03:57:30,671] {standard_task_runner.py:92} ERROR - Failed to execute job 28 for task virtualenv_python
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 393, in execute
    return super().execute(context=serializable_context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 432, in execute_callable
    string_args_filename,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/process_utils.py", line 172, in execute_in_subprocess
    raise subprocess.CalledProcessError(exit_code, cmd)
subprocess.CalledProcessError: Command '['/tmp/venvbcqyfdg4/bin/python', '/tmp/venvbcqyfdg4/script.py', '/tmp/venvbcqyfdg4/script.in', '/tmp/venvbcqyfdg4/script.out', '/tmp/venvbcqyfdg4/string_args.txt']' returned non-zero exit status 1.
[2024-02-24 03:57:30,741] {local_task_job.py:154} INFO - Task exited with return code 1
[2024-02-24 03:57:30,787] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
